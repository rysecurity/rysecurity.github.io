<!DOCTYPE html> <html lang="en, ar"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Enhancing Security in Active Directory; A Comprehensive Guide to Protected Users Group (Arabic) | </title> <meta name="author" content=" "> <meta name="description" content="Three paths to attack protected user and mitigation strategies"> <meta name="keywords" content="CyberSecurity, Pentesing, Hacking, Defense"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/192x192.jpg?4cd79c9ad0146cf0a2be01ce9b7ead10"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://rysecurity.github.io/blog/2024/images1/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Enhancing Security in Active Directory; A Comprehensive Guide to Protected Users Group (Arabic)</h1> <p class="post-meta"> Created in August 06, 2024 </p> <p class="post-tags"> <a href="/blog/2024"> <i class="fa-solid fa-calendar fa-sm"></i> 2024 </a>   ·   <a href="/blog/tag/active-directory"> <i class="fa-solid fa-hashtag fa-sm"></i> Active-Directory</a>   ·   <a href="/blog/category/active-directory"> <i class="fa-solid fa-tag fa-sm"></i> Active-Directory</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <p><b> ما هو قروب المستخدمين المحميين؟ </b></p> <p>قروب المستخدمين المحميين هي ميزة أمان مقدمة في ويندوز سيرفر 2012 والإصدارات الأحدث من الاكتف دايركتوري.تم تصميم هذا القروب لتعزيز أمان الحسابات ذات الصلاحيات العالية من خلال تطبيق سياسات أمنية صارمة تخفف من أنواع معينة من هجمات سرقة كلمات المرور. تهدف هذه السياسات إلى الحد من أساليب وبروتوكولات المصادقة التي يمكن لأعضاء هذا القروب استخدامها، ومن ثم تقلل من مخاطر كشف كلمات المرور وإساءة استخدامها.</p> <p><b> :المميزات </b></p> <p>.(AES) يتم تقيد اعضاء "المستخدمين المحميين" لاستخدام معايير التشفير المتقدمة #</p> <p>NTLM لأعضاء قروب المستخدمين المحميين. يعد NTLM authentication يتم تعطيل <b>:NTLM authentication لايتم استعمال #</b></p> <p>.Pass-the-hash بروتوكول أقل أمانا وأكثر عرضة لهجمات سرقة كلمات المرور مثل</p> <p>للمستخدمين المحميين تكون على مدة 4 ساعات بشكل Kerberos (TGT) <b>: Kerberos تم تقليل عمر تذكرة#</b></p> <p>.افتراضي. وهذا يقلل من الفترة التي يمكن خلالها إساءة استخدام التذكرة المسروقة</p> <p>لايتم تخزين كلمات المرور مؤقتا على الكمبيوتر <b>:(no cached credentials) لا يتم تخزين كلمات المرور #</b></p> <p>.Lsass وبهاذا الحل يتم منع المهاجمين من الحصول على كلمات المرور المخزنه في</p> <p>لا يمكن للأعضاء تسجيل الدخول بشكل تفاعلي الى اجهزة <b>:(Interactive Logon Restrictions) تم تقيد تسجيل الدخول التفاعلي #</b></p> <p>الكمبيوتر التي لا تدعم سياسات الأمان التي تفرضها قروب المستخدمين المحميين. وهذا يضمن استخدام هذه الحسابات عالية القيمة.</p> <p>.فقط على أنظمة امنة وموثوقة</p> <p><b>لماذا نستخدم قروب المستخدمين المحميين؟ </b></p> <p>السبب الرئيسي لاستخدام قروب "المستخدمين المحميين" هو توفير أمان محسّن للحسابات ذات الصلاحيات العالية, غالبًا ما يتم استهداف هذه الحسابات من قبل المهاجمين بسبب صلاحياتهم العالية وامكانية وصول الحسابات لبيانات حساسة.</p> <p><b>:الهجمات المحتملة </b></p> <p>على الرغم من التدابير الأمنية المحسنة التي يوفرها قروب "المستخدمون المحميون"، قد يستمر المهاجمون في محاولة استهداف هذه الحسابات. نحتاج نفهم هاذه الهجمات المحتملة وكيفية التخفيف منها </p> <p>لنفترض أن لدينا حساب (ادمن2) ويملك صلاحية (دومين ادمن), سنقوم بمحاولة تخمين كلمة المرور للحساب ثم الوصول للجهاز واستخراج كلمات المرور من الذاكرة, لنجد الهاش الخاص بحساب (ادمن2)</p> <div class="row" style="text-align: center;"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/1.JPG" class="img-fluid rounded z-depth-1" width="100%" height="auto" style=" max-width: 855px; " data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="row" style="text-align: center;"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/2.JPG" class="img-fluid rounded z-depth-1" width="100%" height="auto" style=" max-width: 455px; " data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>الان سيتم اضافة المستخدم (ادمن2) إلى قروب المستخدمين المحميين ومن ثم تخمين كلمة المرور و pass-the-hash</p> <div class="row" style="text-align: center;"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/3.JPG" class="img-fluid rounded z-depth-1" width="100%" height="auto" style=" max-width: 455px; " data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="row" style="text-align: center;"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/4.JPG" class="img-fluid rounded z-depth-1" width="100%" height="auto" style=" max-width: 755px; " data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="row" style="text-align: center;"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/5.JPG" class="img-fluid rounded z-depth-1" width="100%" height="auto" style=" max-width: 755px; " data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>هاذه المرة يتم الرد علينا برسالة مختلفة عن السابق, بعد اضافة المستخدم في قروب المستخدمين المحميين</p> <p>وأخيرًا، سيتم استخراج كلمات المرور من الذاكرة وتبين أنه لم يتم تخزين الهاش الخاص بالمستخدم</p> <div class="row" style="text-align: center;"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/3-1.JPG" class="img-fluid rounded z-depth-1" width="100%" height="auto" style=" max-width: 455px; " data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>crack ntlm hash إذا تمكنا من protected users group (admin2) سيناريو الهجوم الأول، يمكننا استهداف سيناريو الهجوم الأول، يمكننا استهداف (ادمن2) المضاف في قروب المستخدمين المحميين إذا تمكنا من كسر الهاش</p> <div dir="rtl"> سيتم استعمال Rubeus لإنشاء تذكرة AES256 باستخدام كلمة مرور التي تم الحصول عليها مسابقا </div> <div class="row" style="text-align: center;"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/6.JPG" class="img-fluid rounded z-depth-1" width="100%" height="auto" style=" max-width: 455px; " data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div dir="rtl"> بعد ذلك يمكننا طلب تذكرة TGT بنجاح باستخدام Rubeus </div> <div class="row" style="text-align: center;"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/7.JPG" class="img-fluid rounded z-depth-1" width="100%" height="auto" style=" max-width: 455px; " data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div dir="rtl"> TGT فيمكننا الحصول على تذكرة , \"admin2\" سيناريو الهجوم الثاني، إذا تمكنا من الوصول إلى جهاز تم تسجيل دخول المستخدم </div> <div class="row" style="text-align: center;"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/8.JPG" class="img-fluid rounded z-depth-1" width="100%" height="auto" style=" max-width: 455px; " data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>من ثم، يمكننا استيرادها بنجاح.</p> <div class="row" style="text-align: center;"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/9.JPG" class="img-fluid rounded z-depth-1" width="100%" height="auto" style=" max-width: 455px; " data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div dir="rtl"> سيناريو الهجوم الثالث، يمكننا استهداف مستخدم محدد من قروب المستخدمين المحميين باستخدام password spray </div> <p>Kerberos– مع تحديد Netexec</p> <div class="row" style="text-align: center;"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/10.JPG" class="img-fluid rounded z-depth-1" width="100%" height="auto" style=" max-width: 555px; " data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p><b>:كيفية التصدي</b></p> <p>استخدام كلمة مرور معقدة: عادةً ما تجمع كلمة المرور القوية بين الأحرف الكبيرة والصغيرة والأرقام والعلامات الخاصة، مما يجعل من#</p> <p>الصعب على المهاجمين تخمينها أو اختراقها. تجنب استخدام معلومات يمكن تخمينها بسهولة مثل أعياد الميلاد أو الكلمات الشائعة.</p> <p>إن تحديث كلمات المرور بانتظام واستخدام كلمات مرور فريدة لحسابات مختلفة يعزز من أمانك.</p> <p>المراقبة والتدقيق المنتظم: مراقبة وتدقيق أنشطة الأعضاء في قروب المستخدمين المحميين بشكل مستمر. ابحث عن عمليات تسجيل الدخول#</p> <p>المشبوهة والأنشطة غير العادية التي قد تشير إلى وجود اختراق.</p> <p>استخدام الأنظمة الآمنة: تأكد من أن أعضاء قروب المستخدمين المحميين يسجلون الدخول فقط إلى الأنظمة التي تحتوي على التحديثات#</p> <p>الأمنية وتدعم تدابير الأمان اللازمة</p> <p>Network segmentation و PAM ,MFA اضافة طبقات أمان إضافية مثل: <b>استخدام تدابير أمان إضافية #</b></p> <p>تثقيف وتدريب المستخدمين: تثقيف وتدريب المستخدمين بانتظام على أفضل ممارسات الأمان وأهمية حماية كلمات المرور الخاصة بهم#</p> <p><b>خاتمة</b></p> <p>اضافة قوية لتعزيز أمان الحسابات ذات الصلاحيات العالية Active Directory تعد مجموعة "المستخدمين المحميين" في</p> <p>,من خلال فرض سياسات أمان صارمة والتخفيف من هجمات سرقة كلمات المرور. من خلال فهم ماهو هذه القروب</p> <p>ولماذا يجب استخدامة، ومتى يتم استخدامها، والهجمات المحتملة ضده، يمكن للمؤسسات حماية حساباتها الأكثر أهمية</p> <p>الخاصة بها. تعد المراقبة المنتظمة وتحديثات Active Directory بشكل فعال, وضمان مستوى أعلى من الأمان عبر بيئة </p> <p>."النظام والإجراءات الأمنية الإضافية تساعد في الحفاظ على سلامة قروب "المستخدمين المحميين</p> <p>:لفهم قروب المستخدمين المحميين وتنفيذها بشكل أفضل، راجع المصادر التالية</p> <p>https://learn.microsoft.com/en-us/windows-server/security/credentials-protection-and-management/protected-users-security-group</p> <p>https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/manage/how-to-configure-protected-accounts</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/images/">Enhancing Security in Active Directory; A Comprehensive Guide to Protected Users Group</a> </li> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 . </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> <script type="module" src="/assets/js/search/ninja-keys.min.js?601a2d3465e2a52bec38b600518d5f70"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script>let searchTheme=determineComputedTheme();const ninjaKeys=document.querySelector("ninja-keys");"dark"===searchTheme?ninjaKeys.classList.add("dark"):ninjaKeys.classList.remove("dark");const openSearchModal=()=>{const e=$("#navbarNav");e.hasClass("show")&&e.collapse("hide"),ninjaKeys.open()};</script> <script>const ninja=document.querySelector("ninja-keys");ninja.data=[{id:"nav-about",title:"about",section:"Navigation",handler:()=>{window.location.href="/"}},{id:"nav-blog",title:"blog",description:"",section:"Navigation",handler:()=>{window.location.href="/blog/"}},{id:"nav-projects",title:"projects",description:"",section:"Navigation",handler:()=>{window.location.href="/projects/"}},{id:"post-enhancing-security-in-active-directory-a-comprehensive-guide-to-protected-users-group-arabic",title:"Enhancing Security in Active Directory; A Comprehensive Guide to Protected Users Group (Arabic)...",description:"Three paths to attack protected user and mitigation strategies",section:"Posts",handler:()=>{window.location.href="/blog/2024/images1/"}},{id:"post-enhancing-security-in-active-directory-a-comprehensive-guide-to-protected-users-group",title:"Enhancing Security in Active Directory; A Comprehensive Guide to Protected Users Group",description:"Three paths to attack protected user and mitigation strategies",section:"Posts",handler:()=>{window.location.href="/blog/2024/images/"}},{id:"projects-soon",title:"Soon",description:"",section:"Projects",handler:()=>{window.location.href="/projects/1_project/"}},{id:"socials-linkedin",title:"LinkedIn",section:"Socials",handler:()=>{window.open("https://www.linkedin.com/in/rayan-almutairi-8817a8177","_blank")}},{id:"light-theme",title:"Change theme to light",description:"Change the theme of the site to Light",section:"Theme",handler:()=>{setThemeSetting("light")}},{id:"dark-theme",title:"Change theme to dark",description:"Change the theme of the site to Dark",section:"Theme",handler:()=>{setThemeSetting("dark")}},{id:"system-theme",title:"Use system default theme",description:"Change the theme of the site to System Default",section:"Theme",handler:()=>{setThemeSetting("system")}}];</script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>