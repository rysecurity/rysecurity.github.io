<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en, ar"><generator uri="https://jekyllrb.com/" version="4.3.3">Jekyll</generator><link href="https://rysecurity.github.io/feed.xml" rel="self" type="application/atom+xml"/><link href="https://rysecurity.github.io/" rel="alternate" type="text/html" hreflang="en, ar"/><updated>2024-08-21T23:34:13+00:00</updated><id>https://rysecurity.github.io/feed.xml</id><title type="html">blank</title><subtitle>Exploring the World of Cybersecurity; Learn, Explore, Secure </subtitle><entry><title type="html">Enhancing Security in Active Directory; A Comprehensive Guide to Protected Users Group (Arabic)</title><link href="https://rysecurity.github.io/blog/2024/Protected-Users-Ar/" rel="alternate" type="text/html" title="Enhancing Security in Active Directory; A Comprehensive Guide to Protected Users Group (Arabic)"/><published>2024-08-06T21:01:00+00:00</published><updated>2024-08-06T21:01:00+00:00</updated><id>https://rysecurity.github.io/blog/2024/Protected-Users-Ar</id><content type="html" xml:base="https://rysecurity.github.io/blog/2024/Protected-Users-Ar/"><![CDATA[<h4 id="ما-هو-قروب-المستخدمين-المحميين">ما هو قروب المستخدمين المحميين؟ </h4> <p>قروب المستخدمين المحميين هي ميزة أمان مقدمة في ويندوز سيرفر 2012 والإصدارات الأحدث من الاكتف دايركتوري.تم تصميم هذا القروب لتعزيز أمان الحسابات ذات الصلاحيات العالية من خلال تطبيق سياسات أمنية صارمة تخفف من أنواع معينة من هجمات سرقة كلمات المرور. تهدف هذه السياسات إلى الحد من أساليب وبروتوكولات المصادقة التي يمكن لأعضاء هذا القروب استخدامها، ومن ثم تقلل من مخاطر كشف كلمات المرور وإساءة استخدامها.</p> <h5 id="المميزات">:المميزات</h5> <p><br/><br/></p> <div dir="rtl"> يتم تقيد اعضاء قروب المستخدمين المحميين لاستخدام معايير التشفير المتقدمة (AES). </div> <p><br/><br/></p> <div dir="rtl"> لايتم استعمال NTLM authentication: يتم تعطيل NTLM authentication لأعضاء قروب المستخدمين المحميين يعد NTLM بروتوكول أقل أمانا وأكثر عرضة لهجمات سرقة كلمات المرور مثل pass-the-hash . </div> <p><br/><br/></p> <div dir="rtl"> تم تقليل عمر تذكرة Kerberos (TGT): للمستخدمين المحميين لتكون على مدة 4 ساعات بشكل افتراضي. وهذا يقلل من الفترة التي يمكن من خلالها إساءة استخدام التذكرة المسروقة. </div> <p><br/><br/></p> <div dir="rtl"> لايتم تخزين كلمات المرور (no cached credentials): لا يتم تخزين كلمات المرور وبهاذا الحل يتم منع المهاجمين من الحصول على كلمات المرور المخزنه في Lsass. </div> <p><br/><br/></p> <div dir="rtl"> تم تقيد تسجيل الدخول التفاعلي (Interactive Logon Restrictions): لا يمكن للأعضاء تسجيل الدخول بشكل تفاعلي الى اجهزة الكمبيوتر التي لا تدعم سياسات الأمان التي تفرضها قروب المستخدمين المحميين.وهذا يضمن استخدام هذه الحسابات عالية القيمة فقط على أنظمة امنة وموثوقة. </div> <p><br/><br/></p> <h4 id="لماذا-نستخدم-قروب-المستخدمين-المحميين">لماذا نستخدم قروب المستخدمين المحميين؟ </h4> <p>السبب الرئيسي لاستخدام قروب "المستخدمين المحميين" هو توفير أمان محسّن للحسابات ذات الصلاحيات العالية, غالبًا ما يتم استهداف هذه الحسابات من قبل المهاجمين بسبب صلاحياتهم العالية وامكانية وصول الحسابات لبيانات حساسة.</p> <h4 id="الهجمات-المحتملة">:الهجمات المحتملة </h4> <p>على الرغم من التدابير الأمنية المحسنة التي يوفرها قروب "المستخدمون المحميون"، قد يستمر المهاجمون في محاولة استهداف هذه الحسابات. نحتاج نفهم هاذه الهجمات المحتملة وكيفية التخفيف منها  <br/><br/></p> <div dir="rtl"> لنفترض أن لدينا حساب admin2 ويملك صلاحية domain admin, سنقوم بمحاولة تخمين كلمة المرور password spray للحساب ثم الوصول للجهاز واستخراج كلمات المرور dump lssas, لنجد hash الخاص بحساب admin2 </div> <p><br/><br/></p> <div class="row" style="text-align: center;"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/1.JPG" class="img-fluid rounded z-depth-1" width="100%" height="auto" style=" max-width: 855px; " data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="row" style="text-align: center;"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/2.JPG" class="img-fluid rounded z-depth-1" width="100%" height="auto" style=" max-width: 455px; " data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p><br/><br/></p> <div dir="rtl"> الان سيتم اضافة المستخدم (Admin2) إلى قروب المستخدمين المحميين ومن ثم Password Spray و Pass-the-hash </div> <p><br/><br/></p> <div class="row" style="text-align: center;"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/3.JPG" class="img-fluid rounded z-depth-1" width="100%" height="auto" style=" max-width: 455px; " data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="row" style="text-align: center;"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/4.JPG" class="img-fluid rounded z-depth-1" width="100%" height="auto" style=" max-width: 755px; " data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="row" style="text-align: center;"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/5.JPG" class="img-fluid rounded z-depth-1" width="100%" height="auto" style=" max-width: 755px; " data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>هاذه المرة يتم الرد علينا برسالة مختلفة عن السابق, بعد اضافة المستخدم في قروب المستخدمين المحميين <br/></p> <div dir="rtl"> وأخيرًا، سيتم استخراج كلمات المرور dump hash وتبين أنه لم يتم تخزين الهاش الخاص بالمستخدم </div> <p><br/></p> <div class="row" style="text-align: center;"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/3-1.JPG" class="img-fluid rounded z-depth-1" width="100%" height="auto" style=" max-width: 455px; " data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p><br/><br/></p> <div dir="rtl"> <br/> <h5>سيناريو الهجوم الأول:</h5> <br/> يمكننا استهداف (admin2) المضاف في قروب المستخدمين المحميين إذا تمكنا من crack ntlm hash </div> <div dir="rtl"> سيتم استعمال Rubeus لإنشاء تذكرة AES256 باستخدام كلمة مرور التي تم الحصول عليها مسابقا </div> <p><br/><br/></p> <div class="row" style="text-align: center;"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/6.JPG" class="img-fluid rounded z-depth-1" width="100%" height="auto" style=" max-width: 455px; " data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div dir="rtl"> باستخدام Rubeus يمكننا طلب تذكرة TGT بنجاح </div> <div class="row" style="text-align: center;"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/7.JPG" class="img-fluid rounded z-depth-1" width="100%" height="auto" style=" max-width: 455px; " data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p><br/><br/></p> <div dir="rtl"> <br/> <h5> سيناريو الهجوم الثاني: </h5> <br/> إذا تمكنا من الوصول إلى جهاز تم تسجيل دخول المستخدم admin2 فيه مسبقا, فيمكننا الحصول على تذكرة TGT </div> <p><br/><br/></p> <div class="row" style="text-align: center;"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/8.JPG" class="img-fluid rounded z-depth-1" width="100%" height="auto" style=" max-width: 455px; " data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>من ثم، يمكننا استيرادها بنجاح.</p> <div class="row" style="text-align: center;"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/9.JPG" class="img-fluid rounded z-depth-1" width="100%" height="auto" style=" max-width: 455px; " data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p><br/><br/></p> <div dir="rtl"> <br/> <h5>سيناريو الهجوم الثالث: </h5> <br/> يمكننا استهداف مستخدم محدد من قروب المستخدمين المحميين بهجوم password spray </div> <div dir="rtl"> باستعمال الاداة Netexec مع تحديد Kerberos-- </div> <p><br/><br/></p> <div class="row" style="text-align: center;"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/10.JPG" class="img-fluid rounded z-depth-1" width="100%" height="auto" style=" max-width: 555px; " data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h4 id="كيفية-التصدي">:كيفية التصدي</h4> <p>استخدام كلمة مرور معقدة: عادةً ما تجمع كلمة المرور القوية بين الأحرف الكبيرة والصغيرة والأرقام والعلامات الخاصة، مما يجعل من</p> <p>الصعب على المهاجمين تخمينها أو اختراقها. تجنب استخدام معلومات يمكن تخمينها بسهولة مثل أعياد الميلاد أو الكلمات الشائعة</p> <p>إن تحديث كلمات المرور بانتظام واستخدام كلمات مرور فريدة لحسابات مختلفة يعزز من أمانك.</p> <p>المراقبة والتدقيق المنتظم: مراقبة وتدقيق أنشطة الأعضاء في قروب المستخدمين المحميين بشكل مستمر. ابحث عن عمليات تسجيل الدخول</p> <p>المشبوهة والأنشطة غير العادية التي قد تشير إلى وجود اختراق.</p> <p>استخدام الأنظمة الآمنة: تأكد من أن أعضاء قروب المستخدمين المحميين يسجلون الدخول فقط إلى الأنظمة التي تحتوي على التحديثات</p> <p>الأمنية وتدعم تدابير الأمان اللازمة. <br/><br/></p> <div dir="rtl"> اضافة طبقات أمان إضافية: استخدام تدابير أمان إضافية مثل MFA, PAM و Network segmentation. </div> <p>تثقيف وتدريب المستخدمين: تثقيف وتدريب المستخدمين بانتظام على أفضل ممارسات الأمان وأهمية حماية كلمات المرور الخاصة بهم</p> <h4 id="خاتمة">خاتمة</h4> <p>يعد قروب المستخدمين المحميين في الاكتف دايركتوري اضافة قوية لتعزيز أمان الحسابات ذات الصلاحيات العالية</p> <p>من خلال فرض سياسات أمان صارمة والتخفيف من هجمات سرقة كلمات المرور. من خلال فهم ماهو هذه القروب</p> <p>ولماذا يجب استخدامة، ومتى يتم استخدامه، والهجمات المحتملة ضده، يمكن للمؤسسات حماية حساباتها الأكثر أهمية</p> <p>بشكل فعال وضمان مستوى أعلى من الأمان عبر بيئة الاكتف دايركتوري الخاصة بها.تعد المراقبة المنتظمة</p> <p>وتحديثات النظام وتدابير الأمان الإضافية من المكونات الرئيسية في الحفاظ على سلامة قروب المستخدمين المحميين. <br/><br/></p> <h4 id="لفهم-قروب-المستخدمين-المحميين-وتنفيذها-بشكل-أفضل-راجع-المصادر-التالية">:لفهم قروب المستخدمين المحميين وتنفيذها بشكل أفضل، راجع المصادر التالية</h4> <p><a href="https://learn.microsoft.com/en-us/windows-server/security/credentials-protection-and-management/protected-users-security-group">Microsoft Protected Users Security Group</a></p> <p><a href="https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/manage/how-to-configure-protected-accounts">Microsoft Guidance about how to configure protected accounts</a></p>]]></content><author><name></name></author><category term="Active-Directory"/><category term="Active-Directory"/><summary type="html"><![CDATA[Three paths to attack protected user and mitigation strategies]]></summary></entry></feed>